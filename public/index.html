<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Recorder</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="" />
  </head>

  <body>
    <h1>Recorder</h1>
    <h2>
      A webapp designed to scrobble offline, full album listens to last.fm
    </h2>
    <h3>Current Time:</h3>
    <span id="currTime"></span>
    <button type="button" id="submitButton" onclick="sendTime()">
      Submit Time
    </button>
    <h3 id="confText"></h3>
    <script>
      async function sendTime() {
        const time = getTime();
        const options = {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(time),
        };
        const response = await fetch("/api", options);
        const responseJSON = await response.json();
        if ((responseJSON.status = "success")) {
          document.getElementById(
            "confText"
          ).textContent = `Date and Time Sent to Server! Round Trip Delay of ${
            Date.now() - responseJSON.timestamp
          } milliseconds`;
        } else {
          document.getElementById("confText").textContent =
            "Error: Date and Time Not Sent to Server!";
        }
      }
      function getTime() {
        const date = new Date();
        const timestamp = Date.now();
        return { date: date, timestamp: timestamp };
      }
    </script>
  </body>
</html>
